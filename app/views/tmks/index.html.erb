<%= render partial: 'common/page_title', locals: { titulo: 'Contatos TMK' } %>

<% content_for :actions do %>
    <%= render partial: 'common/btn_add', locals: { url: new_tmk_path, recurso: Tmk.new } %>
<% end %>

<%= form_tag '/tmks', method: :get do %>
    <div class="input-group">
      <%= text_field_tag 'query', nil, class: 'form-control',
                         placeholder: 'Procurar...',
                         value: @query %>
      <span class="input-group-btn">
          <button class="btn btn-default" type="submit" id="btn-search-attrib">
            <span class="glyphicon glyphicon-search"></span>
          </button>

        <%= link_to "<span class=\"glyphicon glyphicon-remove\"></span>".html_safe,
                    tmks_path, class: 'btn btn-default' %>
      </span>
    </div>
<% end %>
<br/>

<table class="table table-striped">
  <tr>
    <th>Contatado</th>
    <th>Evento</th>
    <th>Notas</th>
    <th>Tipo de contato</th>
    <th>Quem fez contato</th>
    <th>Quando</th>
    <th>Ações</th>
  </tr>

  <% @tmks.each do |tmk| %>
      <tr>
        <td><%= link_to tmk.with_who.name, person_path(tmk.with_who) %></td>
        <td><%= link_to tmk.event.name, event_path(tmk.event) %></td>
        <td><%= tmk.notes %></td>
        <td><%= tmk.contact_type %></td>
        <td><%= tmk.from_who.name %></td>
        <td><%= date_display tmk.when %></td>
        <td><%= render partial: 'common/btn_edit', locals: { recurso: tmk,
                                                               size: 'btn-xs', btn_label: '' } %>
          <%= render partial: 'common/btn_delete', locals: { recurso: tmk,
                                                              size: 'btn-xs', btn_label: '' } %>
        </td>
      </tr>
  <% end %>
</table>
<%= paginate @tmks, entry_name: 'pessoas' %>