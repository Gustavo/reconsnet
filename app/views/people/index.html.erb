
<%= render 'common/page_title', titulo: 'Pessoas' %>

<% content_for :actions do %>
    <%= render 'common/btn_add', resource: Person.new %>
<% end %>


<!-- Text field de busca -->

<%= form_tag '/people', method: :get do %>
    <div class="input-group">
      <%= text_field_tag 'query', nil, class: 'form-control',
                         placeholder: 'Procurar...',
                         value: @query %>
      <span class="input-group-btn">
          <button class="btn btn-default" type="submit" id="btn-search">
            <span class="glyphicon glyphicon-search"></span>
          </button>

          <%= link_to "<span class=\"glyphicon glyphicon-remove\"></span>".html_safe,
                    people_path, class: 'btn btn-default' %>
      </span>
    </div>
<% end %>
<br/>


<!-- Ordenar por... -->

<div>
  <span class="text-muted">Ordenar por: </span>
  <%=
      state = current_page?(params.merge(order: 'name')) ? 'active' : ''
      link_to 'Nome', people_path(params.merge(order: 'name')), class: "btn btn-default btn-xs #{state}"
  %>
  <%=
      state = current_page?(params.merge(order: 'created_at')) ? 'active' : ''
      link_to 'Data de cadastramento', people_path(params.merge(order: 'created_at')), class: "btn btn-default btn-xs #{state}"
  %>
</div>
<br/>



<!-- Listagem de pessoas -->

<div class="text-muted"><%= page_entries_info @people %></div>

<table class="table table-striped">
  <tr>
    <th>Nome</th>
    <th>Email</th>
    <th>Telefones</th>
    <th></th>
  </tr>

  <% @people.each do |person| %>
      <tr>
        <td><%= link_to person.name, person_path(person, params) %></td>
        <td><%= person.email %></td>
        <td>
          <% phones = person.phone_numbers.map { |phone| "#{phone.number.phony_formatted}" } %>
          <%= phones.join(' | ') %>
        </td>
        <td><%= render 'common/btn_edit', resource: person, size: 'btn-xs', btn_label: '' %>
            <%= render 'common/btn_delete', resource: person, size: 'btn-xs', btn_label: '' %>
        </td>
      </tr>
  <% end %>
</table>
<%= paginate @people, entry_name: 'pessoas' %>