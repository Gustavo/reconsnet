
<%= render 'common/page_title', titulo: "Evento <em>#{@event.name}</em>".html_safe %>

<% content_for :actions do %>
    <%= render 'common/btn_edit', resource: @event %>
    <%= render 'common/btn_delete', resource: @event %>
<% end %>


<dl class="dl-horizontal">
  <dt>Atividade:</dt>
  <dd><%= activity_link_display @event.activity %></dd>

  <dt>Descrição:</dt>
  <dd><%= @event.description %></dd>

  <dt>Início:</dt>
  <dd><%= date_display @event.start %></dd>

  <dt>Fim:</dt>
  <dd><%= date_display @event.finish %></dd>
</dl>

<!-- Anexos -->
<div class="well">
  <div class="row">
    <div class="col-lg-6">
      <h4>Anexos</h4>
    </div>
    <div class="col-lg-6">
      <h4><!-- O hX deve ser o mesmo do titulo da pagina para os dois ficarem alinhados horizontalmente-->
        <div class="pull-right">
          <%= render 'common/btn_add', url: new_asset_path(assetable_id: @event.id,
                                                           assetable_type: 'Event'), size: 'btn-sm',
                                                            resource: Asset.new %>
        </div>
      </h4>
    </div>
  </div>
  <br/>

  <% if @assets.empty? %>
     <div class="text-muted">Não existem anexos para este evento</div>
  <% else %>
     <table class="table table-striped table-condensed">
        <tr>
          <th>Nome</th>
          <th>Arquivo</th>
          <th>Data upload</th>
          <th></th>
        </tr>
        <% @assets.each do |asset| %>
            <tr>
              <td><%= asset.name %></td>
              <td><%= asset.file_file_name %></td>
              <td><%= date_display asset.created_at %></td>
              <!--A checagem de permissão é feita aqui para a coluna ser ou não gerada e ficar consistente-->
              <!--com o cabeçalho-->
              <td>
                <%= link_to asset.file.url, class: 'btn btn-default btn-xs' do %>
                    <span class="glyphicon glyphicon-download" title="download"></span>
                <% end %>
                <% if policy(@event).edit? %>
                    <%= render 'common/btn_edit', btn_label: '', url: edit_asset_path(asset,
                                                                                      assetable_id: @event.id,
                                                                                      assetable_type: 'Event'),
                                                                 size: 'btn-xs', resource: asset %>
                    <%= render 'common/btn_delete', btn_label: '', url: asset_path(asset,
                                                                                   assetable_id: @event.id,
                                                                                   assetable_type: 'Event'),
                                                                   size: 'btn-xs', resource: asset %>
                <% end %>
              </td>
            </tr>
        <% end %>
     </table>
  <% end %>

</div>

<% if policy(Participation).show? %>
<!-- Participantes -->
<div class="well">
    <div class="row">
      <div class="col-lg-6">
        <h4>Participantes</h4>
      </div>
      <div class="col-lg-6">
        <h4><!-- O hX deve ser o mesmo do titulo da pagina para os dois ficarem alinhados horizontalmente-->
          <div class="pull-right">
            <%= render 'common/btn_emails', size: 'btn-sm' %>
            <%= render 'common/btn_add', url: new_event_participation_path(@event.id), size: 'btn-sm', resource: @event %>
          </div>
        </h4>
      </div>
    </div>
    <br/>

  <% if @participations.empty? %>
    <div class="text-muted">Não existem participantes para este evento</div>
  <% else %>
    <table class="table table-striped table-condensed">
      <tr>
        <th>Nome</th>
        <th>E-mail</th>
        <th>Participação</th>
        <th>Status</th>
        <% if policy(@event).edit? %>
            <th></th>
        <% end %>
      </tr>
      <% @participations.each do |participation| %>
          <tr>
            <td><%= link_to participation.person.name, person_path(participation.person.id) %></td>
            <td><%= participation.person.email %></td>
            <td><%= participation.participation_type %></td>
            <td><%= participation.status %></td>
            <!--A checagem de permissão é feita aqui para a coluna ser ou não gerada e ficar consistente-->
            <!--com o cabeçalho-->
            <% if policy(@event).edit? %>
                <td>
                  <%= render 'common/btn_edit', url: edit_event_participation_path(@event, participation),
                             btn_label: '', size: 'btn-xs', resource: participation %>
                  <%= render 'common/btn_delete', url: event_participation_path(@event, participation),
                             btn_label: '', size: 'btn-xs', resource: participation %>
                </td>
            <% end %>
          </tr>
      <% end %>
    </table>
  <% end %>
</div>
<% end %>